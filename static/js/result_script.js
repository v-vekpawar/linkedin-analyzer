function toggleCollapsible(element) {
    const content = element.nextElementSibling;
    const icon = element.querySelector('i');

    if (content.classList.contains('active')) {
        content.classList.remove('active');
        element.classList.remove('active');
        icon.className = 'fas fa-chevron-down me-2';
    } else {
        content.classList.add('active');
        element.classList.add('active');
        icon.className = 'fas fa-chevron-up me-2';
    }
}

function toggleAllSkills() {
    const remainingSkills = document.getElementById('remaining-skills');
    const button = event.target;
    const icon = button.querySelector('i');

    if (remainingSkills.style.display === 'none') {
        remainingSkills.style.display = 'block';
        icon.className = 'fas fa-chevron-up me-1';
        button.innerHTML = '<i class="fas fa-chevron-up me-1"></i> Show Less Skills';
    } else {
        remainingSkills.style.display = 'none';
        icon.className = 'fas fa-chevron-down me-1';
        button.innerHTML = '<i class="fas fa-chevron-down me-1"></i> View All Skills ({{ profile_data.skills|length }} total)';
    }
}

function copySummary() {
    const summaryText = document.getElementById('summaryText').textContent;
    navigator.clipboard.writeText(summaryText).then(function () {
        const btn = event.target;
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
        btn.style.background = '#28a745';

        setTimeout(function () {
            btn.innerHTML = originalText;
            btn.style.background = '#28a745';
        }, 2000);
    }).catch(function (err) {
        console.error('[LinkedInAnalyzer] Could not copy text to clipboard:', err, { summaryLength: summaryText.length });
        alert('Failed to copy summary to clipboard');
    });
}

// function downloadSummary() {
//     const summaryText = document.getElementById('summaryText').textContent;
//     const profileName = '{{ profile_data.name }}'.replace(/[^a-zA-Z0-9]/g, '_');
//     const summaryType = '{{ analysis_result.mode }}';

//     const content = `LinkedIn Profile Analyzation

// Profile: {{ profile_data.name }}
// Type: ${summaryType}
// Generated: ${new Date().toLocaleString()}

// Result:
// ${summaryText}

// ------------------------------PROFILE INFORMATION:------------------------------

// Name: {{ profile_data.name }}

// Headline: {{ profile_data.headline }}

// About: 
// {{ profile_data.about }}

// Education:
// {% for education in profile_data.education %}
// - {{ education }}
// {% endfor %}

// Experience:
// {% for exp in profile_data.experience %}
// {% if exp is mapping %}
// - {{ exp.title }} at {{ exp.company }}
// {% else %}
// - {{ exp }}
// {% endif %}
// {% endfor %}

// Skills:
// {% for skill in profile_data.skills %}
// - {{ skill }}
// {% endfor %}

// Generated by LinkedIn Profile Analyzer
// `;

//     const blob = new Blob([content], { type: 'text/plain' });
//     const url = window.URL.createObjectURL(blob);
//     const a = document.createElement('a');
//     a.href = url;
//     a.download = `summary_${profileName}_${summaryType}.txt`;
//     document.body.appendChild(a);
//     a.click();
//     window.URL.revokeObjectURL(url);
//     document.body.removeChild(a);
// }

// Auto-scroll to summary on page load
window.onload = function () {
    document.querySelector('.summary-card').scrollIntoView({
        behavior: 'smooth',
        block: 'start'
    });
};